<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>에브라임 스터디카페 문의</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
            padding: 40px;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        h2 {
            color: #764ba2;
            text-align: center;
            margin-bottom: 25px;
            font-size: 20px;
        }

        .btn {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            color: #333;
            font-weight: bold;
            margin-bottom: 8px;
        }

        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        .back-btn {
            background: #6c757d;
            margin-top: 10px;
        }

        .back-btn:hover {
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);
        }

        .success-message {
            text-align: center;
            color: #333;
            line-height: 1.8;
        }

        .phone-list {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .phone-item {
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .phone-item:last-child {
            border-bottom: none;
        }

        .phone-item strong {
            color: #667eea;
        }

        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 1페이지: 지점 선택 -->
        <div id="page1" class="page active">
            <h1>에브라임 스터디카페</h1>
            <h2>직영점 문의사항</h2>
            <button class="btn" onclick="selectBranch('인천계양본점')">인천계양본점</button>
            <button class="btn" onclick="selectBranch('인천박촌역점')">인천박촌역점</button>
            <button class="btn" onclick="selectBranch('부천상동점')">부천상동점</button>
            <button class="btn" onclick="selectBranch('부천신중동점')">부천신중동점</button>
            <button class="btn" onclick="selectBranch('부평삼산점')">부평삼산점</button>
        </div>

        <!-- 2페이지: 문의 유형 선택 -->
        <div id="page2" class="page">
            <h2 id="selectedBranch"></h2>
            <button class="btn" onclick="selectInquiryType('스터디룸 예약')">스터디룸 예약</button>
            <button class="btn" onclick="selectInquiryType('학습방해행위 신고')">학습방해행위 신고</button>
            <button class="btn" onclick="selectInquiryType('온도조절문의')">온도조절문의</button>
            <button class="btn" onclick="showParkingNotice()">주차안내</button>
            <button class="btn" onclick="selectInquiryType('기타 문의')">그 외 기타 문의</button>
            <button class="btn back-btn" onclick="goToPage(1)">이전</button>
        </div>

        <!-- 3페이지: 문의 내용 작성 -->
        <div id="page3" class="page">
            <h2 id="inquiryTypeTitle"></h2>
            <form id="inquiryForm">
                <div class="form-group">
                    <label for="seatNumber">좌석 번호</label>
                    <input type="text" id="seatNumber" placeholder="예: A-12" required>
                </div>
                <div class="form-group">
                    <label for="inquiryContent">문의 사항</label>
                    <textarea id="inquiryContent" placeholder="문의하실 내용을 상세히 적어주세요" required></textarea>
                </div>
                <button type="submit" class="btn">문의 제출</button>
                <div class="loading" id="loading">전송 중...</div>
                <button type="button" class="btn back-btn" onclick="goToPage(2)">이전</button>
            </form>
        </div>

        <!-- 4페이지: 완료 메시지 -->
        <div id="page4" class="page">
            <div class="success-message">
                <h2>문의가 접수되었습니다</h2>
                <p>최대한 빠르게 문의사항을 해결해드리도록 하겠습니다.</p>
                <div class="phone-list">
                    <div class="phone-item">
                        <strong>인천계양본점</strong><br>
                        032-123-4567
                    </div>
                    <div class="phone-item">
                        <strong>인천박촌역점</strong><br>
                        032-234-5678
                    </div>
                    <div class="phone-item">
                        <strong>부천상동점</strong><br>
                        032-345-6789
                    </div>
                    <div class="phone-item">
                        <strong>부천신중동점</strong><br>
                        032-456-7890
                    </div>
                    <div class="phone-item">
                        <strong>부평삼산점</strong><br>
                        032-567-8901
                    </div>
                </div>
                <button class="btn" onclick="goToPage(1); resetForm();">처음으로</button>
            </div>
        </div>

        <!-- 5페이지: 주차안내 공지 -->
        <div id="page5" class="page">
            <h2 id="parkingBranchTitle"></h2>
            <div class="success-message">
                <div class="phone-list">
                    <div class="phone-item" style="border: none; padding: 20px;">
                        <p id="parkingNoticeContent" style="line-height: 1.8; color: #333; font-size: 16px; white-space: pre-line;"></p>
                    </div>
                </div>
                <button class="btn" onclick="goToPage(2)">이전</button>
                <button class="btn back-btn" onclick="goToPage(1)">처음으로</button>
            </div>
        </div>
    </div>

    <script>
        let selectedBranch = '';
        let selectedInquiryType = '';

        const parkingInfo = {
            '인천계양본점': '지하주차장이 있지만 협소하기에 참고하시기 바랍니다',
            '인천박촌역점': '카페 뒤편에 주차장소가 있지만 매우 협소하기에 참고하시기 바랍니다',
            '부천상동점': '지하 주차장은 무료(들어가기 매우 협소), 카페 옆 공영주차장은 사이드부분만 무료이니 참고해주시기 바랍니다.',
            '부천신중동점': '주차가 불가하니 참고해주시기 바랍니다.',
            '부평삼산점': '아파트 주차장이 있으나 이용하기 어려울 때가 있으니 참고해주시기 바랍니다'
        };

        function goToPage(pageNum) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById('page' + pageNum).classList.add('active');
        }

        function selectBranch(branch) {
            selectedBranch = branch;
            document.getElementById('selectedBranch').textContent = branch;
            goToPage(2);
        }

        function selectInquiryType(type) {
            selectedInquiryType = type;
            document.getElementById('inquiryTypeTitle').textContent = `${selectedBranch} - ${type}`;
            document.getElementById('inquiryContent').value = '';
            goToPage(3);
        }

        function showParkingNotice() {
            const info = parkingInfo[selectedBranch];
            document.getElementById('parkingBranchTitle').textContent = `${selectedBranch} 주차 안내`;
            document.getElementById('parkingNoticeContent').textContent = info;
            goToPage(5);
        }

        function resetForm() {
            document.getElementById('inquiryForm').reset();
            document.getElementById('inquiryContent').value = '';
            selectedBranch = '';
            selectedInquiryType = '';
        }

        document.getElementById('inquiryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const seatNumber = document.getElementById('seatNumber').value;
            const inquiryContent = document.getElementById('inquiryContent').value;
            const loading = document.getElementById('loading');
            
            const message = `🔔 새로운 문의가 접수되었습니다\n\n` +
                          `🏢 지점: ${selectedBranch}\n` +
                          `📋 문의 유형: ${selectedInquiryType}\n` +
                          `💺 좌석 번호: ${seatNumber}\n\n` +
                          `📝 문의 내용:\n${inquiryContent}`;
            
            loading.style.display = 'block';
            
            try {
                const response = await fetch('/api/sendMessage', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message })
                });

                if (response.ok) {
                    goToPage(4);
                } else {
                    alert('문의 전송에 실패했습니다. 다시 시도해주세요.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('문의 전송 중 오류가 발생했습니다. 다시 시도해주세요.');
            } finally {
                loading.style.display = 'none';
            }
        });
    </script>
</body>
</html>
